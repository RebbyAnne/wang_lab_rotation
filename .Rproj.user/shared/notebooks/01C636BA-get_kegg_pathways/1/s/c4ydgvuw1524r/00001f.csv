"0","genes <- unique(gene_metadata$geneSymbol)"
"0",""
"0","pathway_df <- data.frame(GeneSymbol = character(),"
"0","                       PathwayID = character(),"
"0","                       PathwayName = character(),"
"0","                       stringsAsFactors = FALSE)"
"0",""
"0","get_kegg_pathways <- function(gene) {"
"0","  tryCatch({"
"0","    # Prepend 'hsa:' for human genes (adjust this prefix for other organisms as needed)"
"0","    gene_with_prefix <- paste(""hsa:"", gene, sep="""")"
"0","    "
"0","    # Fetch KEGG data for the gene"
"0","    gene_info <- keggGet(gene_with_prefix)"
"0","    "
"0","    # Check if the gene has any pathways"
"0","    if (is.null(gene_info[[1]]$PATHWAY) || length(gene_info[[1]]$PATHWAY) == 0) {"
"0","      return(NULL)  # Return NULL if no pathways exist"
"0","    }"
"0","    "
"0","    if (is.null(gene_info[[1]]$ORTHOLOGY) || length(gene_info[[1]]$ORTHOLOGY) == 0) {"
"0","      return(NULL)  # Return NULL if no pathways exist"
"0","    }"
"0","    "
"0","    # Extract pathway information"
"0","    orthology <- gene_info[[1]]$ORTHOLOGY"
"0","    ortho_ids <- names(orthology)"
"0","    ortho_names <- as.vector(orthology)"
"0","    "
"0","    pathways <- gene_info[[1]]$PATHWAY"
"0","    pathway_ids <- names(pathways)  # The names are the pathway IDs"
"0","    pathway_names <- as.vector(pathways)       # The values are the pathway names"
"0","    "
"0","    # Return data as a data frame directly"
"0","    data.frame("
"0","      gene_symbol = gene,"
"0","      kegg_pathway_id = pathway_ids,"
"0","      kegg_pathway_name = pathway_names,"
"0","      kegg_orthology_id = ortho_ids,"
"0","      kegg_orthology_name = ortho_names"
"0","    )"
"0","    "
"0","  }, error = function(e) {"
"0","    return(NULL)  # Return NULL if there is an error"
"0","  })"
"0","}"
"0",""
"0",""
"0","for (gene in genes) {"
"0","  gene_data <- get_kegg_pathways(gene)"
"0","  "
"0","  if (!is.null(gene_data)) {"
"0","    pathway_df <- rbind(pathway_df, gene_data)  # Append the gene's pathway data to final_df"
"0","  } else {"
"0","    pathway_df <- rbind(pathway_df, data.frame(gene_symbol = gene, "
"0","                                               kegg_pathway_id = NA, "
"0","                                               kegg_pathway_name = NA, "
"0","                                               kegg_orthology_id = NA, "
"0","                                               kegg_orthology_name = NA))"
"0","  }"
"0","}"
"0",""
"0","write.csv(pathway_df, paste(directory, ""/kegg_pathway_metadata.csv"", sep=""""))"
"0",""
